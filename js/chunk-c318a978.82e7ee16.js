(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c318a978"],{"0213":function(e,t,n){"use strict";n.r(t);var c=n("7a23"),a={class:"container"},l={class:"text-end mt-10 mb-3"},r={class:"table text-primary"},o=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"購買時間"),Object(c["createElementVNode"])("th",null,"Email"),Object(c["createElementVNode"])("th",null,"購買款項"),Object(c["createElementVNode"])("th",null,"應付金額"),Object(c["createElementVNode"])("th",null,"是否付款"),Object(c["createElementVNode"])("th",null,"編輯")])],-1),d=["textContent"],i={class:"list-unstyled text-primary"},s={class:"text-right"},b={class:"form-check form-switch"},m=["id","onUpdate:modelValue"],u=["for"],O={key:0},p={key:1},j={class:"btn-group"},g=["onClick"],h=["onClick"];function E(e,t,n,E,N,V){var f=Object(c["resolveComponent"])("PaginationOrder"),k=Object(c["resolveComponent"])("DeleteOrderModal"),v=Object(c["resolveComponent"])("UpdateOrderModal"),y=Object(c["resolveComponent"])("Loading");return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],null,[Object(c["createElementVNode"])("div",a,[Object(c["createElementVNode"])("div",l,[Object(c["createElementVNode"])("button",{type:"button",class:"btn btn-danger",value:"全部刪除",onClick:t[0]||(t[0]=function(){return V.deleteAllOrder&&V.deleteAllOrder.apply(V,arguments)})},"全部刪除")]),Object(c["createElementVNode"])("table",r,[o,Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(N.orders,(function(e,t){return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],{key:t},[N.orders.length?(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:0,class:Object(c["normalizeClass"])({"text-secondary":!e.is_paid})},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(V.changeDate(e.create_at)),1),Object(c["createElementVNode"])("td",null,[e.user?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",{key:0,textContent:Object(c["toDisplayString"])(e.user.email)},null,8,d)):Object(c["createCommentVNode"])("",!0)]),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("ul",i,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.products,(function(e,t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("li",{key:t},Object(c["toDisplayString"])(e.product.title)+" 數量："+Object(c["toDisplayString"])(e.qty)+" "+Object(c["toDisplayString"])(e.product.unit),1)})),128))])]),Object(c["createElementVNode"])("td",s,Object(c["toDisplayString"])(e.total),1),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("div",b,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"form-check-input",type:"checkbox",id:"paidSwitch".concat(e.id),"onUpdate:modelValue":function(t){return e.is_paid=t}},null,8,m),[[c["vModelCheckbox"],e.is_paid]]),Object(c["createElementVNode"])("label",{class:"form-check-label",for:"paidSwitch".concat(e.id)},[e.is_paid?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",O,"已付款")):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",p,"未付款"))],8,u)])]),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("div",j,[Object(c["createElementVNode"])("button",{class:"btn btn-outline-primary btn-sm",type:"button",onClick:function(t){return V.openOrderModal(e)}}," 檢視 ",8,g),Object(c["createElementVNode"])("button",{class:"btn btn-danger btn-sm",type:"button",onClick:function(t){return V.openDeleteOrderModal(e)}}," 刪除 ",8,h)])])],2)):Object(c["createCommentVNode"])("",!0)],64)})),128))])])]),Object(c["createVNode"])(f,{pagination:N.pagination,onGetOrder:V.getOrder},null,8,["pagination","onGetOrder"]),Object(c["createVNode"])(k,{onGetOrder:V.getOrder},null,8,["onGetOrder"]),Object(c["createVNode"])(v,{onGetOrder:V.getOrder},null,8,["onGetOrder"]),Object(c["createVNode"])(y,{active:N.isLoading,"onUpdate:active":t[1]||(t[1]=function(e){return N.isLoading=e})},null,8,["active"])],64)}n("99af"),n("ac1f"),n("5319"),n("e9c4");var N=n("c6e3"),V=(n("b0c0"),{class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"}),f={class:"modal-dialog modal-dialog-centered",role:"document"},k={class:"modal-content border-0"},v={class:"modal-header bg-danger text-white"},y={class:"modal-title"},B=Object(c["createElementVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),D={class:"modal-body"},x=Object(c["createTextVNode"])(" 是否刪除 "),S={class:"text-danger"},C=Object(c["createTextVNode"])(" (刪除後將無法恢復)。 "),M={class:"modal-footer"},L=Object(c["createElementVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function w(e,t,n,a,l,r){var o,d,i,s,b=Object(c["resolveComponent"])("Loading");return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],null,[Object(c["createElementVNode"])("div",V,[Object(c["createElementVNode"])("div",f,[Object(c["createElementVNode"])("div",k,[Object(c["createElementVNode"])("div",v,[Object(c["createElementVNode"])("h5",y,[Object(c["createElementVNode"])("span",null,"刪除 ( "+Object(c["toDisplayString"])(l.order.id)+" ) ",1)]),B]),Object(c["createElementVNode"])("div",D,[x,Object(c["createElementVNode"])("strong",S,Object(c["toDisplayString"])(null===(o=l.order)||void 0===o||null===(d=o.user)||void 0===d?void 0:d.email)+" / "+Object(c["toDisplayString"])(null===(i=l.order)||void 0===i||null===(s=i.user)||void 0===s?void 0:s.name),1),C]),Object(c["createElementVNode"])("div",M,[L,Object(c["createElementVNode"])("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=function(e){return r.deleteOrder(l.order.id)})}," 確認刪除 ")])])])],512),Object(c["createVNode"])(b,{active:l.isLoading,"onUpdate:active":t[1]||(t[1]=function(e){return l.isLoading=e})},null,8,["active"])],64)}var _=n("7c2b"),F=n.n(_),$={inject:["emitter"],data:function(){return{delModal:"",order:[],isLoading:!1}},methods:{deleteOrder:function(e){var t=this;this.isLoading=!0;var n="".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("mizupath72","/admin/order/").concat(e);this.$http.delete(n,{data:this.tempOrder}).then((function(e){t.isLoading=!1,t.$httpMessageState(e.data.success,"刪除訂單"),t.delModal.hide(),t.$emit("getOrder")})).catch((function(e){t.isLoading=!1,t.$httpMessageState(e.success,"刪除訂單")}))}},mounted:function(){var e=this;this.delModal=new F.a(document.getElementById("delModal")),this.emitter.on("openDeleteOrderModal",(function(t){e.order=t,e.delModal.show()}))},unmounted:function(){this.emitter.off("openDeleteOrderModal")}},z=n("d959"),U=n.n(z);const A=U()($,[["render",w]]);var G=A,I={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},J={class:"modal-dialog modal-xl modal-dialog-centered text-dark",role:"document"},P={class:"modal-content border-0"},T=Object(c["createElementVNode"])("div",{class:"modal-header bg-dark text-white"},[Object(c["createElementVNode"])("h5",{class:"modal-title",id:"exampleModalLabel"},[Object(c["createElementVNode"])("span",null,"訂單細節")]),Object(c["createElementVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),q={class:"modal-body"},X={class:"row"},H={class:"col-md-4"},K=Object(c["createElementVNode"])("h3",null,"用戶資料",-1),Q={class:"table"},R={key:0},W=Object(c["createElementVNode"])("th",{style:{width:"100px"}},"姓名",-1),Y=Object(c["createElementVNode"])("th",null,"Email",-1),Z=Object(c["createElementVNode"])("th",null,"電話",-1),ee=Object(c["createElementVNode"])("th",null,"地址",-1),te={class:"col-md-8"},ne=Object(c["createElementVNode"])("h3",null,"訂單細節",-1),ce={class:"table"},ae=Object(c["createElementVNode"])("th",{style:{width:"100px"}},"訂單編號",-1),le=Object(c["createElementVNode"])("th",null,"下單時間",-1),re=Object(c["createElementVNode"])("th",null,"付款時間",-1),oe={key:0},de={key:1},ie=Object(c["createElementVNode"])("th",null,"付款狀態",-1),se={key:0,class:"text-success"},be={key:1,class:"text-muted"},me=Object(c["createElementVNode"])("th",null,"總金額",-1),ue=Object(c["createElementVNode"])("h3",null,"選購商品",-1),Oe={class:"table"},pe=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr")],-1),je={class:"text-end"},ge={class:"d-flex justify-content-end"},he={class:"form-check"},Ee={class:"form-check-label",for:"flexCheckDefault"},Ne={key:0},Ve={key:1},fe={class:"modal-footer"},ke=Object(c["createElementVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ve(e,t,n,a,l,r){var o=Object(c["resolveComponent"])("Loading");return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],null,[Object(c["createElementVNode"])("div",I,[Object(c["createElementVNode"])("div",J,[Object(c["createElementVNode"])("div",P,[T,Object(c["createElementVNode"])("div",q,[Object(c["createElementVNode"])("div",X,[Object(c["createElementVNode"])("div",H,[K,Object(c["createElementVNode"])("table",Q,[l.tempOrder.user?(Object(c["openBlock"])(),Object(c["createElementBlock"])("tbody",R,[Object(c["createElementVNode"])("tr",null,[W,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(l.tempOrder.user.name),1)]),Object(c["createElementVNode"])("tr",null,[Y,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(l.tempOrder.user.email),1)]),Object(c["createElementVNode"])("tr",null,[Z,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(l.tempOrder.user.tel),1)]),Object(c["createElementVNode"])("tr",null,[ee,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(l.tempOrder.user.address),1)])])):Object(c["createCommentVNode"])("",!0)])]),Object(c["createElementVNode"])("div",te,[ne,Object(c["createElementVNode"])("table",ce,[Object(c["createElementVNode"])("tbody",null,[Object(c["createElementVNode"])("tr",null,[ae,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(l.tempOrder.id),1)]),Object(c["createElementVNode"])("tr",null,[le,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(r.changeDate(l.tempOrder.create_at)),1)]),Object(c["createElementVNode"])("tr",null,[re,Object(c["createElementVNode"])("td",null,[l.tempOrder.paid_date?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",oe,Object(c["toDisplayString"])(r.changeDate(l.tempOrder.paid_date)),1)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",de,"時間不正確"))])]),Object(c["createElementVNode"])("tr",null,[ie,Object(c["createElementVNode"])("td",null,[l.tempOrder.is_paid?(Object(c["openBlock"])(),Object(c["createElementBlock"])("strong",se,"已付款")):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",be,"尚未付款"))])]),Object(c["createElementVNode"])("tr",null,[me,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(l.tempOrder.total),1)])])]),ue,Object(c["createElementVNode"])("table",Oe,[pe,Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(l.tempOrder.products,(function(e){return Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:e.id},[Object(c["createElementVNode"])("th",null,Object(c["toDisplayString"])(e.product.title),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.qty)+" / "+Object(c["toDisplayString"])(e.product.unit),1),Object(c["createElementVNode"])("td",je,Object(c["toDisplayString"])(e.final_total),1)])})),128))])]),Object(c["createElementVNode"])("div",ge,[Object(c["createElementVNode"])("div",he,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"form-check-input",type:"checkbox",id:"flexCheckDefault","onUpdate:modelValue":t[0]||(t[0]=function(e){return l.tempOrder.is_paid=e})},null,512),[[c["vModelCheckbox"],l.tempOrder.is_paid]]),Object(c["createElementVNode"])("label",Ee,[l.tempOrder.is_paid?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",Ne,"已付款")):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",Ve,"未付款"))])])])])])]),Object(c["createElementVNode"])("div",fe,[ke,Object(c["createElementVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=function(e){return r.updateOrder(l.tempOrder.id)})}," 修改付款狀態 ")])])])],512),Object(c["createVNode"])(o,{active:e.isLoading,"onUpdate:active":t[2]||(t[2]=function(t){return e.isLoading=t})},null,8,["active"])],64)}var ye={inject:["emitter"],data:function(){return{order_modal:"",tempOrder:{create_at:"",id:"",isLoading:!1}}},methods:{changeDate:function(e){return new Date(1e3*e).toISOString().substring(0,10)},updateOrder:function(e){var t=this;this.isLoading=!0;var n="".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("mizupath72","/admin/order/").concat(e);this.$http.put(n,{data:this.tempOrder}).then((function(e){t.isLoading=!1,t.$httpMessageState(e.data.success,"修改訂單"),t.$emit("getOrder"),t.order_modal.hide()})).catch((function(e){t.isLoading=!1,t.$httpMessageState(e.success,"修改訂單")}))}},mounted:function(){var e=this;this.order_modal=new F.a(document.getElementById("productModal")),this.emitter.on("openOrderModal",(function(t){e.tempOrder=t,e.order_modal.show()}))},unmounted:function(){this.emitter.off("openOrderModal")}};const Be=U()(ye,[["render",ve]]);var De=Be,xe={"aria-label":"Page navigation example"},Se={class:"pagination justify-content-center"},Ce=Object(c["createElementVNode"])("span",{"aria-hidden":"true"},"«",-1),Me=[Ce],Le=["onClick"],we=Object(c["createElementVNode"])("span",{"aria-hidden":"true"},"»",-1),_e=[we];function Fe(e,t,n,a,l,r){return Object(c["openBlock"])(),Object(c["createElementBlock"])("nav",xe,[Object(c["createElementVNode"])("ul",Se,[Object(c["createElementVNode"])("li",{class:Object(c["normalizeClass"])(["page-item",{disabled:!n.pagination.has_pre}])},[Object(c["createElementVNode"])("a",{class:"page-link bg-dark",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=Object(c["withModifiers"])((function(t){return e.$emit("getOrder",n.pagination.current_page-1)}),["prevent"]))},Me)],2),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(n.pagination.total_pages,(function(t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("li",{class:Object(c["normalizeClass"])(["page-item",{active:t===n.pagination.current_page}]),key:t},[Object(c["createElementVNode"])("a",{class:"page-link bg-dark",href:"#",onClick:Object(c["withModifiers"])((function(n){return e.$emit("getOrder",t)}),["prevent"])},Object(c["toDisplayString"])(t),9,Le)],2)})),128)),Object(c["createElementVNode"])("li",{class:Object(c["normalizeClass"])(["page-item",{disabled:!n.pagination.has_next}])},[Object(c["createElementVNode"])("a",{class:"page-link bg-dark",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=Object(c["withModifiers"])((function(t){return e.$emit("getOrder",n.pagination.current_page+1)}),["prevent"]))},_e)],2)])])}var $e={props:["pagination"]};const ze=U()($e,[["render",Fe]]);var Ue=ze,Ae={provide:function(){return{emitter:N["a"]}},components:{PaginationOrder:Ue,UpdateOrderModal:De,DeleteOrderModal:G},data:function(){return{orders:[],pagination:[],isLoading:!1}},methods:{getOrder:function(e){var t=this;this.isLoading=!0;var n="".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("mizupath72","/admin/orders?page=").concat(e);this.$http.get(n).then((function(e){t.isLoading=!1,t.pagination=e.data.pagination,t.orders=e.data.orders}))},openOrderModal:function(e){N["a"].emit("openOrderModal",e)},openDeleteOrderModal:function(e){N["a"].emit("openDeleteOrderModal",e)},changeDate:function(e){return new Date(1e3*parseInt(e)).toLocaleString().replace(/:\d{1,2}$/," ")},deleteAllOrder:function(){var e=this;this.isLoading=!0;var t="".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("mizupath72","/admin/orders/all");this.$http.delete(t).then((function(){e.isLoading=!1,e.getOrder()}))}},mounted:function(){this.getOrder(),localStorage.setItem("current_page",JSON.stringify("order"))}};const Ge=U()(Ae,[["render",E]]);t["default"]=Ge},b0c0:function(e,t,n){var c=n("83ab"),a=n("5e77").EXISTS,l=n("e330"),r=n("9bf2").f,o=Function.prototype,d=l(o.toString),i=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,s=l(i.exec),b="name";c&&!a&&r(o,b,{configurable:!0,get:function(){try{return s(i,d(this))[1]}catch(e){return""}}})},e9c4:function(e,t,n){var c=n("23e7"),a=n("da84"),l=n("d066"),r=n("2ba4"),o=n("e330"),d=n("d039"),i=a.Array,s=l("JSON","stringify"),b=o(/./.exec),m=o("".charAt),u=o("".charCodeAt),O=o("".replace),p=o(1..toString),j=/[\uD800-\uDFFF]/g,g=/^[\uD800-\uDBFF]$/,h=/^[\uDC00-\uDFFF]$/,E=function(e,t,n){var c=m(n,t-1),a=m(n,t+1);return b(g,e)&&!b(h,a)||b(h,e)&&!b(g,c)?"\\u"+p(u(e,0),16):e},N=d((function(){return'"\\udf06\\ud834"'!==s("\udf06\ud834")||'"\\udead"'!==s("\udead")}));s&&c({target:"JSON",stat:!0,forced:N},{stringify:function(e,t,n){for(var c=0,a=arguments.length,l=i(a);c<a;c++)l[c]=arguments[c];var o=r(s,null,l);return"string"==typeof o?O(o,j,E):o}})}}]);
//# sourceMappingURL=chunk-c318a978.82e7ee16.js.map